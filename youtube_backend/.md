# YouTube Clone â€” Imtihon loyiha texnik topshiriq (Ð¢Ð—)

## 1. Umumiy maqsad

Loyihaning maqsadi frontend va backend boâ€˜yicha amaliy koâ€˜nikmalarini tekshirish: fayl yuklash, video oqimi va koâ€˜rish sahifasi, autentifikatsiya, video konvertatsiyasi, konteynerizatsiya va serverga joylash.

## 2. Texnologik stek

- **Frontend:** React.js (hooks, react-router). CSS: Tailwind yoki plain CSS (talab boâ€˜lsa).
- **Backend:** Express.js yoki NestJS (tanlovi muallim tomonidan tasdiqlanadi).
- **Ma'lumotlar bazasi:** PostgreSQL yoki MongoDB (tanlov muallim bilan).
- **Media storage:** Mahalliy fayl tizimi server/volume yoki ob-havo (masalan: S3 â€” fakultativ)
- **Video processing:** FFmpeg (serverda ishga tushadi) â€” transkodlash, thumbnail yaratish, short kesimlar.
- **Autentifikatsiya:** Google OAuth2 (Sign in with Google) + sessiyalar yoki JWT saqlash uchun cookie (HttpOnly).
- **Docker:** Har bir xizmat uchun Dockerfile va docker-compose.yml.
- **HTTPS:** nginx reverse-proxy + certbot yoki boshqa TLS provayderi.

## 3. Umumiy funktsiyalar (majburiy)

1. **Roâ€˜yxatdan oâ€˜tish / Login**
   - Google OAuth (majburiy).
   - Oddiy email/parol (ixtiyoriy, ammo balldagi bonus uchun).
2. **Video yuklash**
   - Foydalanuvchi video yuklashi mumkin (max hajm â€” 5000mb).
   - Yuklangan video serverga saqlanadi va keyin FFmpeg orqali kerakli formatlarga konvert qilinadi (mp4 H.264, mobil uchun pastroq bitrate va resolution).
   - Thumbnail avtomatik yaratiladi.
3. **Videolarni olish va koâ€˜rsatish**
   - Bosh sahifa: paginated video roâ€˜yxati (page & limit) va sort (yangi, ommabop).
   - Video ustiga bosilganda alohida **video view page** ochilishi â€” video pleer, sarlavha, tavsif, uploaded by, like/ dislike (yoki like), commentlar.
   - Video streaming yoki range requests (soâ€˜rov boâ€˜lsa) â€” minimal sifatida statik MP4 xizmatini qoâ€˜llash.
4. **Shorts rejimi**
   - Mobile-style vertikal videolar uchun alohida roâ€˜yxat/endpoint â€” `isShort` flag bilan yoki duration < 60s bilan aniqlash.
5. **Like bosish**
   - Auth qilingan foydalanuvchi videoga like bosishi mumkin; like qayd etiladi va soni yangilanadi.
6. **Pagination**
   - API list endpointlari `page`, `limit` yoki cursor-based boâ€˜lishi mumkin.
7. **Video konvertatsiyasi**
   - FFmpeg yordamida yuklangan videodan bir nechta resolution (1080p/720p/480p/360p) va thumbnail yaratish.
8. **Cookie / Sessiya**
   - Autentifikatsiya uchun HttpOnly cookie ishlatish (token yoki session id).
9. **HTTPS**
   - Sinov serveri HTTPS orqali kirishni ta'minlashi kerak (nginx + certbot yoki self-signed TLS test).
10. **Docker & Deploy**
    - Loyihaning frontend, backend va (agar alohida boâ€˜lsa) DB/FFmpeg uchun containerlari boâ€˜lishi; `docker-compose` bilan ishga tushirilishi.

## 4. Batafsil texnik talablar

### 4.1 Frontend (React)

- React Router bilan marshrutlar: `/`, `/login`, `/upload`, `/video/:id`, `/shorts`, `/profile`.
- Upload form: sarlavha, tavsif, thumbnail (auto) yoki foydalanuvchi yuklashi, privacy (public/private), tags.
- Video pleer: HTML5 video element (supports `controls`, `poster`, `playsInline`). Range requests server tomonda qoâ€˜llab-quvvatlanishi kerak boâ€˜lsa hbetter UX.
- Google OAuth tugmasi; cookie orqali sessiyani saqlash.
- Like tugma: asinxron API chaqiriqlari, optimistic UI muomalasi (ixtiyoriy).

### 4.2 Backend (Express yoki NestJS)

**Asosiy endpointlar (misol format):**

- `POST /api/auth/google` â€” Google OAuth callback (creds muhitda).
- `GET /api/auth/user` â€” joriy foydalanuvchi ma'lumotini qaytaradi (cookie orqali).
- `POST /api/videos` â€” video yuklash (multipart/form-data).
- `GET /api/videos` â€” video roâ€˜yxati (query: page, limit, sort, short=true).
- `GET /api/videos/:id` â€” bitta video va meta ma'lumotlari.
- `GET /media/:filename` â€” serv qilinadigan video fayllar (statik yoki proxied)
- `POST /api/videos/:id/like` â€” like qoâ€˜yish.
- `GET /api/videos/:id/comments` `POST /api/videos/:id/comments` â€” commentlar.

**Video processing pipeline:**

1. Fayl serverga yuklanadi (temp folder).
2. Background worker yoki spawn qilinadigan FFmpeg jarayoni:
   - Transkodlash tarmoqli: 1080p, 720p, 480p, 360p (faqat talab qilinganlar).
   - Poster (thumbnail) yaratiladi (masalan `ffmpeg -ss 00:00:01 -i input -frames:v 1 -q:v 2 out.jpg`).
   - Optional: short (30s) uchun avtomatik kesimlar yoki foydalanuvchi belgilaydi.
3. Bazaga meta (URL, duration, resolutions, sizes) saqlanadi.

**DB schema (soddalashtirilgan):**

- `users` { id, googleId, name, email, avatarUrl, createdAt }
- `videos` { id, ownerId, title, description, tags[], thumbnails: {small, large}, files: [{res:'720p', url}], duration, isShort, privacy, likesCount, createdAt }
- `likes` { id, userId, videoId, createdAt }
- `comments` { id, userId, videoId, text, createdAt }

### 4.3 Security va Qoida

- Cookies: `HttpOnly`, `SameSite=Lax` yoki `Strict` (muvofiq).
- HTTPS: barcha trafik TLS orqali boâ€˜lishi kerak.
- Input validation va file type/size check (faqat video mime tiplari: `video/mp4, video/webm`, va hk).
- Rate limiting: login va video upload uchun.
- Sanitize user-generated content (XSS himoyasi uchun tavsif va commentlarni escape qilish).

### 4.4 Deployment

- **Dockerfiles**: frontend (build static), backend (node app), ffmpeg qatlam (ffmpeg oâ€˜rnatilgan image yoki ffmpeg server image).
- **docker-compose.yml**: services: `nginx`, `frontend`, `backend`, `db`, `worker` (ffmpeg processor).
- **Nginx**: reverse proxy, TLS termination, static fayllarni xizmat qilish (yoki CDN bilan ishlash mumkin).
- **Certbot**: real domain boâ€˜lsa Letâ€™s Encrypt uchun.

## 5. Testlash va qabul qilish mezonlari (baholash)

**Umumiy ball:** 100

- Backend API ishlashi: 25 ball
  - Video upload, konvertatsiya pipeline, meta saqlash â€” 15
  - Pagination va list endpointlari â€” 5
  - Like & comment endpointlari â€” 5
- Frontend (React): 30 ball
  - Roâ€˜yxat, video sahifa, upload form, login â€” 20
  - Shorts sahifasi va pagination â€” 5
  - UI/UX, responsive dizayn â€” 5
- Autentifikatsiya va xavfsizlik: 15 ball
  - Google OAuth + cookie ishlashi, HTTPS â€” 10
  - Input validation va security headers â€” 5
- Deployment va konteynerizatsiya: 15 ball
  - Dockerfile va docker-compose bilan ishga tushishi â€” 10
  - Nginx + HTTPS (self-signed yoki certbot) â€” 5
- Bonus (maks 15 ball):
  - Adaptive streaming (HLS/DASH) â€” 8
  - Background worker + job queue (BullMQ/Redis) â€” 4
  - Email notifications yoki upload progress bar server-side â€” 3

**Oâ€˜tish minimal ball:** 60/100

## 6. Talab qilingan hujjatlar va topshirish

1. GitHub repo link (yoki zip) â€” frontend va backend alohida papkalar bilan.
2. `README.md` â€” loyihani qanday ishga tushirish, muhit oâ€˜zgaruvchilari (Google OAuth creds, DB URL), portlar.
3. Dockerfile va docker-compose.yml.
4. Postman collection yoki API documentatsiyasi (Postman/Swagger).
5. Qisqa video demo (3-5 daqiqa) â€” asosiy funktsiyalarni koâ€˜rsatish (ixtiyoriy, lekin tavsiya qilinadi).

## 7. Qoâ€˜shimcha tavsiyalar

- Yuklash va konvertatsiyani asinxron qiling (upload visual progress va keyin status polling / webhooks).
- Katta hajmdagi fayllar uchun chunked upload (ixtiyoriy, murakkablik boâ€˜yicha bonus).
- Agar vaqt kam boâ€˜lsa, minimal funksionallikga e'tibor bering: upload â†’ konvert â†’ view page â†’ like â†’ google auth â†’ docker-compose.

## 8. Tekshirish jarayoni (nazorat roâ€˜yxati)

- [ ] GitHub repo mavjud va commitlar mavjud.
- [ ] README va docker-compose.yml ishlaydi.
- [ ] Foydalanuvchi Google bilan tizimga kirishi mumkin.
- [ ] Video yuklash va konvertatsiya ishlaydi (thumbnail yaratiladi).
- [ ] Video view page ochiladi va video pleer ishlaydi.
- [ ] Like funksiyasi ishlaydi va bazada saqlanadi.
- [ ] Pagination ishlaydi (page & limit yoki cursor).
- [ ] TLS/HTTPS orqali kirish amalga oshadi (test muhitida self-signed qabul qilinadi yoki real certbot).

---
